<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Tutorial</title>

<script src="site_libs/header-attrs-2.7/header-attrs.js"></script>
<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/sandstone.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<script src="site_libs/kePrint-0.0.1/kePrint.js"></script>
<link href="site_libs/lightable-0.0.1/lightable.css" rel="stylesheet" />

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>





<link rel="stylesheet" href="style.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.tab('show');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-sm-12 col-md-4 col-lg-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-sm-12 col-md-8 col-lg-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">R Basic</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li>
  <a href="tutorial.html">Tutorial</a>
</li>
<li>
  <a href="more_resources.html">More Resources</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">



<h1 class="title toc-ignore">Tutorial</h1>

</div>


<p><br></p>
<div id="learning-r-fundamentals" class="section level1" number="1">
<h1 number="1"><span class="header-section-number">1</span> Learning R fundamentals</h1>
<p><br></p>
<div id="basic-operators-and-datatypes" class="section level2" number="1.1">
<h2 number="1.1"><span class="header-section-number">1.1</span> <font color="red">Basic operators and datatypes</font></h2>
<p><br></p>
<div id="arithmetic-operators" class="section level3" number="1.1.1">
<h3 number="1.1.1"><span class="header-section-number">1.1.1</span> <font color="red">Arithmetic operators</font></h3>
<p>Arithmetic operators in R works as the normal mathematic operators and follow the order of operations/calculations.</p>
<pre class="r"><code>20 * 4 + 1</code></pre>
<pre><code>## [1] 81</code></pre>
<p>Just as in mathematics operations, parentheses <code>()</code> can be used to change the order of operations.</p>
<pre class="r"><code>20 * (4 + 1)</code></pre>
<pre><code>## [1] 100</code></pre>
<p><br></p>
<blockquote>
<p>More arithmetic operators:</p>
</blockquote>
<table class="table" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
Mathematics operators
</th>
<th style="text-align:left;">
R arithmetic operators
</th>
<th style="text-align:left;">
Descriptions
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
a + b
</td>
<td style="text-align:left;">
a + b
</td>
<td style="text-align:left;">
a plus b
</td>
</tr>
<tr>
<td style="text-align:left;">
a - b
</td>
<td style="text-align:left;">
a - b
</td>
<td style="text-align:left;">
a minus b
</td>
</tr>
<tr>
<td style="text-align:left;">
a <span class="math inline">\(\times\)</span> b
</td>
<td style="text-align:left;">
a * b
</td>
<td style="text-align:left;">
a multiply b
</td>
</tr>
<tr>
<td style="text-align:left;">
a <span class="math inline">\(\div\)</span> b
</td>
<td style="text-align:left;">
a / b
</td>
<td style="text-align:left;">
a divided by b
</td>
</tr>
<tr>
<td style="text-align:left;">
a <span class="math inline">\(\%\)</span> b
</td>
<td style="text-align:left;">
a %% b
</td>
<td style="text-align:left;">
remainder of a divided by b
</td>
</tr>
<tr>
<td style="text-align:left;">
<span class="math inline">\(a ^ b\)</span>
</td>
<td style="text-align:left;">
a ^ b
</td>
<td style="text-align:left;">
a raised to the bth power
</td>
</tr>
</tbody>
</table>
<hr />
<p>Way more than a calculator, R can not only operate on numerical values, but also on <code>vectors</code>, an important data type in R. Vectorization makes R very efficient in operating with high dimensional data.</p>
<p>You can define a vector as below:</p>
<pre class="r"><code>c(1, 2, 3)</code></pre>
<pre><code>## [1] 1 2 3</code></pre>
<p>Operate on vectors:</p>
<pre class="r"><code>c(2, 4, 3)</code></pre>
<pre><code>## [1] 2 4 3</code></pre>
<pre class="r"><code>c(2, 4, 3) / 2</code></pre>
<pre><code>## [1] 1.0 2.0 1.5</code></pre>
<pre class="r"><code>c(2, 4, 3) + c(1, 2, 3)</code></pre>
<pre><code>## [1] 3 6 6</code></pre>
<pre class="r"><code>c(2, 4, 3) / 2 + c(1, 2, 3) * 3</code></pre>
<pre><code>## [1]  4.0  8.0 10.5</code></pre>
<style>
div.Tip1, div.Tip2, div.Tip3, div.Tip4 {
  padding: 1em;
  margin: 1em 0;
  padding-left: 100px;
  background-size: 70px;
  background-repeat: no-repeat;
  background-position: 15px center;
  min-height: 120px;
  color: #1f5386;
  background-color: #bed3ec;
  border: solid 5px #dfedff;
  background-image: url("images/lightbulb.jpg")
}
</style>
<div class="Tip1">
<p><strong>NOTE</strong></p>
<p>Some frequently used R-objects are: “Vectors”, “Lists”, “Matrices”, “Arrays”, “Factors”, and “Dataframes”.</p>
<p>“Vectors” which we just worked with is probably the simplest and most fundamental object. Vectors can be of six classes: Logical (e.g., TRUE, FALSE), Numeric (e.g., 20.34, 100), Integer (e.g., 0L, 3L), Complex (e.g., 3+2i), Character (e.g., ‘Hello world’, ‘3.14’, ‘z’), and Raw (e.g., <code>charToRaw("math")</code>).</p>
<p>Later we will also go through dataframes in this workshop.</p>
</div>
<p>No matter which R object we are working with, sometimes it may not be easy to directly embed these data into a math operation or other functions as above (e.g., what if the data is a <span class="math inline">\(1000 \times 10000\)</span> matrix). Instead we will assign and store the data / value to a so-called “variable”.</p>
<p><br></p>
</div>
<div id="assignment-operators" class="section level3" number="1.1.2">
<h3 number="1.1.2"><span class="header-section-number">1.1.2</span> <font color="red">Assignment operators</font></h3>
<p>We can assign value to variable with assignment operator <code>&lt;-</code>. Let’s assign <code>c(2, 4, 3)</code> to variable <code>x</code>:</p>
<pre class="r"><code>x &lt;- c(2, 4, 3)
x</code></pre>
<pre><code>## [1] 2 4 3</code></pre>
<pre class="r"><code>x / 2</code></pre>
<pre><code>## [1] 1.0 2.0 1.5</code></pre>
<pre class="r"><code>y &lt;- x / 2
y</code></pre>
<pre><code>## [1] 1.0 2.0 1.5</code></pre>
<p>Shortcut for assignment operator:</p>
<ul>
<li>In Windows: <code>Alt</code> + <code>-</code><br />
</li>
<li>In Mac: <code>Cmd</code> + <code>-</code></li>
</ul>
<p><br></p>
</div>
<div id="exercise" class="section level3" number="1.1.3">
<h3 number="1.1.3"><span class="header-section-number">1.1.3</span> <font color="red">Exercise</font></h3>
<ul>
<li>Assign <code>c(15, 256, 11)</code> to variable <code>num</code><br />
</li>
<li>Check if each number in <code>num</code> is odd</li>
</ul>
<p><br></p>
</div>
</div>
<div id="functions-and-packages" class="section level2" number="1.2">
<h2 number="1.2"><span class="header-section-number">1.2</span> <font color="orange">Functions and Packages</font></h2>
<p><br></p>
<p><strong>1. Functions</strong></p>
<p>The base R has many useful built-in functions that maybe helpful to your data. The normal syntax of using a function is as such: <code>function_name(argument 1, argument 2, ...)</code></p>
<ul>
<li><code>print</code> can be used to display information</li>
</ul>
<pre class="r"><code>y</code></pre>
<pre><code>## [1] 1.0 2.0 1.5</code></pre>
<pre class="r"><code>print(y)</code></pre>
<pre><code>## [1] 1.0 2.0 1.5</code></pre>
<ul>
<li><code>sort</code>: Order a vector into ascending or descending order.</li>
</ul>
<pre class="r"><code># function name: sort; argument: y
sort(y)</code></pre>
<pre><code>## [1] 1.0 1.5 2.0</code></pre>
<p>We just sorted a vector in ascending order, but how to do it in descending order? <strong>How to get all the arguments info of a function and learn how to use a function?</strong></p>
<ul>
<li>Normally, you can find the detailed description, usage, and arguments information in the function/package R documentation. Search the R Documentation by <code>?function_name</code> or search R help files with a word or phrase by <code>??regresion</code>:</li>
</ul>
<pre class="r"><code>?sort

# sort vector y in descending order
sort(y, decreasing = TRUE)</code></pre>
<pre><code>## [1] 2.0 1.5 1.0</code></pre>
<pre class="r"><code>??regresion</code></pre>
<ul>
<li>The second way is just to Google!</li>
</ul>
<p><br></p>
<p><strong>2. Packages</strong></p>
<p>There are many basic and useful functions in base R. Sometimes the functions you want to use may not be included in base R, but instead in a specific R package. That’s when we need to install the package.</p>
<p><code>dplyr</code> is a R package that we will use for data manipulation later in this workshop.</p>
<pre class="r"><code># install the package
install.packages(&quot;dplyr&quot;)

# load and attach add-on packages
library(dplyr)</code></pre>
<div class="Tip2">
<p><strong>NOTE</strong></p>
<p>Most of the times, you can find help about the function/package that you are interested in from its documentation or online sources. But if your work needs some specific functions or the same chunk of code is reused multiple times, it’s always a good idea to write your own functions or even packages! See these resources of <a href="https://swcarpentry.github.io/r-novice-inflammation/02-func-R/">creating functions</a> and <a href="http://web.mit.edu/insong/www/pdf/rpackage_instructions.pdf">your own R package</a>.</p>
</div>
<p><br></p>
<div id="exercise-1" class="section level3" number="1.2.1">
<h3 number="1.2.1"><span class="header-section-number">1.2.1</span> <font color="orange">Exercise</font></h3>
<ul>
<li><code>ggplot2</code> is a package that makes graphics with user input data and commands. Install and load <code>ggplot2</code>.</li>
</ul>
<p><br></p>
</div>
</div>
</div>
<div id="data-exploring-with-r" class="section level1" number="2">
<h1 number="2"><span class="header-section-number">2</span> Data exploring with R</h1>
<p><br></p>
<div id="accessing-elements-in-dataframes" class="section level2" number="2.1">
<h2 number="2.1"><span class="header-section-number">2.1</span> <font color="darkgoldenrod">Accessing elements in dataframes</font></h2>
<p><br></p>
<p><strong>1. Accessing elements in a vector use <code>[index]</code> or <code>[index_start : index_end]</code></strong></p>
<pre class="r"><code>z &lt;- c(y, 200)
z</code></pre>
<pre><code>## [1]   1.0   2.0   1.5 200.0</code></pre>
<pre class="r"><code># access the third element in z
z[3]</code></pre>
<pre><code>## [1] 1.5</code></pre>
<pre class="r"><code># access the second to forth elements in z
z[2:4]</code></pre>
<pre><code>## [1]   2.0   1.5 200.0</code></pre>
<hr />
<p><br></p>
<p><strong>2. Import data to R</strong></p>
<p>In practice, we may often work with a dataframe that looks like this:</p>
<table class="table" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
mpg
</th>
<th style="text-align:right;">
cyl
</th>
<th style="text-align:right;">
disp
</th>
<th style="text-align:right;">
hp
</th>
<th style="text-align:right;">
drat
</th>
<th style="text-align:right;">
wt
</th>
<th style="text-align:right;">
qsec
</th>
<th style="text-align:right;">
vs
</th>
<th style="text-align:right;">
am
</th>
<th style="text-align:right;">
gear
</th>
<th style="text-align:right;">
carb
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Mazda RX4
</td>
<td style="text-align:right;">
21.0
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
160
</td>
<td style="text-align:right;">
110
</td>
<td style="text-align:right;">
3.90
</td>
<td style="text-align:right;">
2.620
</td>
<td style="text-align:right;">
16.46
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
4
</td>
</tr>
<tr>
<td style="text-align:left;">
Mazda RX4 Wag
</td>
<td style="text-align:right;">
21.0
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
160
</td>
<td style="text-align:right;">
110
</td>
<td style="text-align:right;">
3.90
</td>
<td style="text-align:right;">
2.875
</td>
<td style="text-align:right;">
17.02
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
4
</td>
</tr>
<tr>
<td style="text-align:left;">
Datsun 710
</td>
<td style="text-align:right;">
22.8
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
108
</td>
<td style="text-align:right;">
93
</td>
<td style="text-align:right;">
3.85
</td>
<td style="text-align:right;">
2.320
</td>
<td style="text-align:right;">
18.61
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
Hornet 4 Drive
</td>
<td style="text-align:right;">
21.4
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
258
</td>
<td style="text-align:right;">
110
</td>
<td style="text-align:right;">
3.08
</td>
<td style="text-align:right;">
3.215
</td>
<td style="text-align:right;">
19.44
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
Hornet Sportabout
</td>
<td style="text-align:right;">
18.7
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
360
</td>
<td style="text-align:right;">
175
</td>
<td style="text-align:right;">
3.15
</td>
<td style="text-align:right;">
3.440
</td>
<td style="text-align:right;">
17.02
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
2
</td>
</tr>
</tbody>
</table>
<p>Before talking about how to access values in such dataframes, let’s first see how we can import a dataset into R:</p>
<pre class="r"><code>?read.table()
ghg &lt;- read.table(&quot;/Users/liujia/Desktop/europ_agriculture_GHG.csv&quot;, header = TRUE, sep = &quot;,&quot;)</code></pre>
<pre class="r"><code># open the dataset in R
View(ghg)</code></pre>
<p>This is a dataset of greenhouse emission from agricultural area of European countries during Year <span class="math inline">\(1990\)</span>-<span class="math inline">\(2006\)</span>. The original dataset was downloaded from the <a href="https://data.europa.eu/euodp/en/data/dataset?q=air+emission&amp;vocab_catalog=http%3A%2F%2Fdata.europa.eu%2F88u%2Fcatalog%2Feuodp&amp;ext_boolean=all&amp;sort=">European Union Open Data Portal</a>. I simplified the data so that it fits our workshop better.</p>
<p><br></p>
<p>Let’s take a quick look at the data:</p>
<pre class="r"><code># return the first parts of the object which is dataframe &quot;ghg&quot; here
head(ghg)</code></pre>
<pre><code>##   Country_code Country Sector_code      Sector Pollutant Year    Value Units
## 1           AT Austria           4 Agriculture       CH4 1990 230015.5    Mg
## 2           AT Austria           4 Agriculture       CH4 1991 226798.0    Mg
## 3           AT Austria           4 Agriculture       CH4 1992 218327.0    Mg
## 4           AT Austria           4 Agriculture       CH4 1993 218808.7    Mg
## 5           AT Austria           4 Agriculture       CH4 1994 219121.4    Mg
## 6           AT Austria           4 Agriculture       CH4 1995 220144.6    Mg</code></pre>
<pre class="r"><code># return the last parts
tail(ghg)</code></pre>
<pre><code>##      Country_code Country Sector_code      Sector Pollutant Year    Value Units
## 2171           TR  Turkey           4 Agriculture       N2O 2001 424.0000    Mg
## 2172           TR  Turkey           4 Agriculture       N2O 2002 444.0000    Mg
## 2173           TR  Turkey           4 Agriculture       N2O 2003 438.0000    Mg
## 2174           TR  Turkey           4 Agriculture       N2O 2004 484.0000    Mg
## 2175           TR  Turkey           4 Agriculture       N2O 2005 510.2228    Mg
## 2176           TR  Turkey           4 Agriculture       N2O 2006 510.2228    Mg</code></pre>
<pre class="r"><code># return the number of rows
nrow(ghg)</code></pre>
<pre><code>## [1] 2176</code></pre>
<pre class="r"><code># return the number of columns
ncol(ghg)</code></pre>
<pre><code>## [1] 8</code></pre>
<pre class="r"><code># return the dimensions
dim(ghg)</code></pre>
<pre><code>## [1] 2176    8</code></pre>
<blockquote>
<p>Notice that the datasets you work with in practical may not be clean, for example, there maybe missing values. <a href="https://uc-r.github.io/missing_values">Here</a> is a link that talks about how to deal with missing values in R. You may find more solutions or suggestions online.</p>
</blockquote>
<p><br></p>
<p><strong>3. Accessing elements in a dataframe</strong></p>
<p>You can get a specific column of a dataframe by df_name$colume_name`:</p>
<pre class="r"><code>ghg$Country</code></pre>
<p>Accessing elements with <code>df_name[r_index, c_index]</code></p>
<ul>
<li><code>r_index</code>/<code>c_index</code> can be row/column numbers or ranges. For example, get the element at row 3, column 6:</li>
</ul>
<pre class="r"><code>ghg[3, 6]</code></pre>
<pre><code>## [1] 1992</code></pre>
<p>If you want to get specific row(s), then specify the row number(s) and leave the column part empty, <code>df_name[r_index, ]</code>. For example, you can get the first three rows by:</p>
<pre class="r"><code># return the first 3 rows
ghg[1:3, ]</code></pre>
<p>If you just want to select specific column(s), then leave the row index empty, <code>df_name[ , c_index]</code>. Here you can get the last 5 columns by:</p>
<pre class="r"><code># return the last 5 columns
head(ghg[ , 4:8])</code></pre>
<ul>
<li><code>c_index</code> can be column names.</li>
</ul>
<pre class="r"><code>ghg[ , c(&quot;Country&quot;, &quot;Year&quot;)]</code></pre>
<ul>
<li><code>r_index</code> can be relational operator</li>
</ul>
<p>We can get the records that are after Year <span class="math inline">\(2000\)</span>:</p>
<pre class="r"><code>ghg[ghg$Year &gt; 2000, ]</code></pre>
<p>Or we may only be interested in “CO2” pollutant, so get the rows of only CO2 by:</p>
<pre class="r"><code>ghg[ghg$Pollutant == &quot;CO2&quot;, ]</code></pre>
<p>The symbol <code>&gt;</code> and <code>==</code> we used above are so called “relational operator”. Normally a relational operator will return a logical type (TRUE / FALSE) based on the relationship between its leftside and rightside. Then the outer part of the code, if there’s any, will decide what to do based on the logical type.</p>
<hr />
<blockquote>
<p>Relational operator:</p>
</blockquote>
<ul>
<li><code>==</code>: checks if the left side values equal to that of the right side. So in the example above, for each row, if its <code>Pollutant</code> value is “CO2”, the row will be filtered as one of the output.</li>
<li><code>&gt;</code>: greater than</li>
<li><code>&lt;</code>:less than</li>
<li><code>&lt;=</code>: less than or equal to</li>
<li><code>&gt;=</code>: greater than or equal to</li>
<li><code>!=</code>: unequal to</li>
</ul>
<hr />
<p>What about if I am interested with the data of both CO2 and after Year 2000?</p>
<p>You can include both two conditions with <code>&amp;</code> (<strong>AND</strong>):</p>
<pre class="r"><code>ghg[ghg$Year &gt; 2000 &amp; ghg$Pollutant == &quot;CO2&quot;, ]</code></pre>
<p>The <code>|</code> (<strong>OR</strong>) operator returns true if its leftside or rightside is true. For example, we can get all the rows of pollutant as “CO2” or “CH4” by:</p>
<pre class="r"><code>ghg[ghg$Pollutant == &quot;CO2&quot; | ghg$Pollutant == &quot;CH4&quot;, ]</code></pre>
<p>The <code>&amp;</code> and <code>|</code> we just saw are two logical operators.</p>
<hr />
<blockquote>
<p>Logical operator:</p>
</blockquote>
<ul>
<li><code>!x</code>: NOT x</li>
<li><code>x | y</code>: x OR y</li>
<li><code>x &amp; y</code>: x AND y</li>
</ul>
<hr />
<div class="Tip3">
<p><strong>NOTE</strong></p>
<p>R’s basic subsetting operators are powerful. It allows you to adopt different methods, such as relational and logical operators to extract the useful information. I am including some good online resources here about subsetting: <a href="https://hughjonesd.github.io/subsetting.html">Everything I know about R subsetting</a>, and <a href="https://adv-r.hadley.nz/subsetting.html">subsetting in the book <em>Advanced R</em></a>.</p>
</div>
<p><br></p>
<div id="exercise-2" class="section level3" number="2.1.1">
<h3 number="2.1.1"><span class="header-section-number">2.1.1</span> <font color="darkgoldenrod">Exercise</font></h3>
<ul>
<li>Sort the “Value” column of <code>ghg</code> dataframe</li>
</ul>
<p><br></p>
</div>
</div>
<div id="data-wrangling-with-tidyverse" class="section level2" number="2.2">
<h2 number="2.2"><span class="header-section-number">2.2</span> <font color="darkgoldenrod">Data wrangling with <code>tidyverse</code></font></h2>
<p><br></p>
<p>In the last Exercise, you applied one function <code>sort</code> to a dataframe. Sometimes, you may need to use multiple functions, say 10, to a dataframe before you get the final set that you like. Through this long process, you either store the output of each function to a variable and use it as an input of the next function, or use some function commands with data as the argument of the next function. Either way, it can be messy and easy to lose control of.</p>
<p>In <code>dplyr</code> package, there is a pipe operator <code>%&gt;%</code>, which allows you to transfer the data or output of the previous function to be as the default input data of the next function:</p>
<pre class="r"><code>df_name %&gt;% 
  function1( ... arguments)  %&gt;% 
  function2( ... arguments) %&gt;% 
  function3( ... arguments)</code></pre>
<p>There are some very useful <code>dplyr</code> functions that can help us work with data. We will learn about some of them today.</p>
<hr />
<div id="select-columns-of-interest" class="section level3" number="2.2.1">
<h3 number="2.2.1"><span class="header-section-number">2.2.1</span> <font color="green"><strong>Select</strong> columns of interest</font></h3>
<p>Again with the <code>ghg</code> data:</p>
<pre class="r"><code>head(ghg)</code></pre>
<pre><code>##   Country_code Country Sector_code      Sector Pollutant Year    Value Units
## 1           AT Austria           4 Agriculture       CH4 1990 230015.5    Mg
## 2           AT Austria           4 Agriculture       CH4 1991 226798.0    Mg
## 3           AT Austria           4 Agriculture       CH4 1992 218327.0    Mg
## 4           AT Austria           4 Agriculture       CH4 1993 218808.7    Mg
## 5           AT Austria           4 Agriculture       CH4 1994 219121.4    Mg
## 6           AT Austria           4 Agriculture       CH4 1995 220144.6    Mg</code></pre>
<p>We can know from the data description that all these data are from agriculture area, so the <code>Sector</code> and <code>Sector_code</code> columns are not really useful here. Also, we’ve already known that the <code>Units</code> for all the pollutant have all been unified to the same equivalance of <span class="math inline">\(CO_2\)</span>, so “Units” column doesn’t help explaining any specific information. I am not interested in “Country_code” column neither. So the columns that I am really interested are <code>Country</code>, <code>Pollutant</code>, <code>Year</code>, <code>Value</code>.</p>
<p>To select these columns:</p>
<pre class="r"><code>select(ghg, Country, Pollutant, Year, Value)

ghg %&gt;% 
  select(Country, Pollutant, Year, Value) </code></pre>
<p>We can achieve the same goal by unselect the columns of not interested:</p>
<pre class="r"><code>ghg %&gt;% 
  select(-c(Country_code, Sector, Sector_code, Units))</code></pre>
<blockquote>
<p><a href="https://suzan.rbind.io/2018/01/dplyr-tutorial-1/#selecting-columns-the-basics">More</a> options for selecting columns.</p>
</blockquote>
<p><br></p>
</div>
<div id="filter-rows-of-interest" class="section level3" number="2.2.2">
<h3 number="2.2.2"><span class="header-section-number">2.2.2</span> <font color="blue"><strong>Filter</strong> rows of interest</font></h3>
<p>We may be interested in rows with specific patterns. For example, all the rows with <code>Pollutant == CO2</code>:</p>
<pre class="r"><code>ghg %&gt;% 
  select(Country, Pollutant, Year, Value) %&gt;% 
  filter(Pollutant == &quot;CO2&quot;)</code></pre>
<p>You can filter out rows with <code>Year &gt; 2000</code> by:</p>
<pre class="r"><code>ghg %&gt;% 
  select(Country, Pollutant, Year, Value) %&gt;% 
  filter(Year &gt; 2000)</code></pre>
<p>In many situations, we may need to filter out rows with multiple conditions. For example, I can filter all the rows with <code>Year &gt; 2000</code> and <code>Pollutant == "CO2"</code> by combining these two conditions with <code>&amp;</code>:</p>
<pre class="r"><code>ghg %&gt;% 
  select(Country, Pollutant, Year, Value) %&gt;% 
  filter(Year &gt; 2000 &amp; Pollutant == &quot;CO2&quot;)</code></pre>
<p><br></p>
<div id="exercise-3" class="section level4" number="2.2.2.1">
<h4 number="2.2.2.1"><span class="header-section-number">2.2.2.1</span> <font color="blue">Exercise</font></h4>
<ul>
<li><p>You will use <code>ghg</code> as your input data, and use the <code>%&gt;%</code> to pipe through functions like what we just did. So,</p>
<ul>
<li>Take <code>ghg</code> data, select columns <code>Country</code>, <code>Pollutant</code>, <code>Year</code>, <code>Value</code> with <code>select</code> function</li>
<li>Filter out rows with <code>Pollutant == N2O</code></li>
<li>Assign the values generated from above to variable <code>N2O_ghg</code> (Hint: use <code>&lt;-</code> to assign value to variable)</li>
</ul></li>
</ul>
<p>Solution:</p>
<pre class="r"><code>N2O_ghg &lt;- ghg %&gt;% 
  select(Country, Pollutant, Year, Value) %&gt;% 
  filter(Pollutant == &quot;N2O&quot;)</code></pre>
<p><br></p>
</div>
</div>
<div id="summarize-and-divide-data" class="section level3" number="2.2.3">
<h3 number="2.2.3"><span class="header-section-number">2.2.3</span> <font color="indigo">Summarize and Divide data</font></h3>
<p>You know how to do some manupulation to your data know. Some basic maths information may help you learn more about your data. <code>summarise()</code> function summarizes some maths such as sum, average, standard deviation, maximum, minimum, and counts of the columns you defined. To apply <code>summarise</code>, you can add your new column name, and let it equals to the math function with the variable. More than one summary functions are possible.</p>
<pre class="r"><code>N2O_ghg %&gt;% 
  summarise(n=n(), average = mean(Value), std = sd(Value), maximum = max(Value))</code></pre>
<pre><code>##     n  average      std  maximum
## 1 544 30398.24 42287.36 202323.2</code></pre>
<p>That’s a big standard deviation. It kinda makes sense since it was calculated through all the countries. A lot of times, we want to summarize the information not through all the data but by a group, say <code>Country</code> in this case. <code>group_by</code> function will divide the data with the columns/variables that you specified, and the latter functions can be applied to each divided data section.</p>
<pre class="r"><code>N2O_ghg %&gt;% 
  group_by(Country) %&gt;% 
  summarise(average = mean(Value), std = sd(Value), maximum = max(Value)) </code></pre>
<pre><code>## # A tibble: 32 x 4
##    Country        average   std maximum
##    &lt;chr&gt;            &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;
##  1 Austria         13390.  900.  14894.
##  2 Belgium         16981.  938.  17868.
##  3 Bulgaria        11711. 4051.  24298.
##  4 Cyprus           1037.  241.   1165.
##  5 Czech Republic  18907. 4110.  30931.
##  6 Denmark         23760. 3254.  29140.
##  7 Estonia          3165. 1302.   6231.
##  8 Finland         13321. 1039.  16018.
##  9 France         187117. 8057. 202323.
## 10 Germany        135265. 6463. 156105.
## # … with 22 more rows</code></pre>
<p>We just got some summaries of each European countries “N2O” gas emission throughout years. <code>arrange</code> function can be used to order a dataset based on values in one or multiple columns you defined. For example, I may want to order the dataset above based on firstly the “average”, and then “std” columns:</p>
<pre class="r"><code>N2O_ghg %&gt;% 
  group_by(Country) %&gt;% 
  summarise(average = mean(Value), std = sd(Value), maximum = max(Value)) %&gt;% 
  arrange(desc(average), std)</code></pre>
<pre><code>## # A tibble: 32 x 4
##    Country        average   std maximum
##    &lt;chr&gt;            &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;
##  1 France         187117. 8057. 202323.
##  2 Germany        135265. 6463. 156105.
##  3 United Kingdom  94891. 6837. 104129.
##  4 Italy           74424. 2530.  78243.
##  5 Spain           72686. 5701.  81671.
##  6 Poland          72536. 7934.  97904.
##  7 Romania         45278. 9637.  73284.
##  8 Netherlands     36396. 4219.  41262.
##  9 Greece          28968. 1739.  32453.
## 10 Ireland         24583. 1151.  26791.
## # … with 22 more rows</code></pre>
<p><code>arrange</code> will sort on ascending order in default. <code>arrange(desc(column_name))</code> will make it sort in descending order of the given column.</p>
<p><br></p>
<div class="Tip4">
<p><strong>NOTE</strong></p>
<p>We just went through a data wrangling process with some functions in <code>dplyr</code>. It also has many other useful functions such as <code>mutate()</code>, <code>relocate()``,</code>slice()`, and so on.</p>
<p>There are many good online resources about how to apply these functions specifically based on your needs. This is a <a href="https://r4ds.had.co.nz/transform.html">good</a> one I found.</p>
</div>
<p><br></p>
</div>
</div>
<div id="bonus-visualizing-data-with-ggplot2" class="section level2" number="2.3">
<h2 number="2.3"><span class="header-section-number">2.3</span> Bonus: visualizing data with <code>ggplot2</code></h2>
<p>asdf</p>
<ul>
<li><p>syntax of ggplot2</p></li>
<li><p>heatmap of N2O for each country in each year</p></li>
</ul>
<pre class="r"><code>library(ggplot2)

N2O_ghg %&gt;% 
  ggplot(aes(x = Country, y = Year)) +
  geom_tile(aes(fill = Value))</code></pre>
<p><img src="tutorial_files/figure-html/unnamed-chunk-36-1.png" width="672" /></p>
<div id="exercise-4" class="section level3" number="2.3.1">
<h3 number="2.3.1"><span class="header-section-number">2.3.1</span> Exercise</h3>
<p>asdf</p>
<p><br></p>
</div>
</div>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->

<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
